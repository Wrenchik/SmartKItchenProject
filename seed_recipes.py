from sqlalchemy.orm import Session
from database import SessionLocal, engine
import models

models.Base.metadata.create_all(bind=engine)
db: Session = SessionLocal()

# ---------- CLEAN ----------
db.query(models.RecipeIngredient).delete()
db.query(models.Recipe).delete()
db.query(models.Product).delete()
db.commit()

# ---------- PRODUCTS ----------
products = [
    ("яйца","fast"), ("молоко","fast"), ("мука","long"), ("масло","long"),
    ("сахар","long"), ("соль","long"), ("сыр","fast"), ("колбаса","fast"),
    ("хлеб","fast"), ("макароны","long"), ("рис","long"), ("курица","fast"),
    ("картофель","long"), ("лук","long"), ("морковь","long"),
    ("помидоры","fast"), ("огурцы","fast"), ("майонез","fast")
]

for name, p in products:
    db.add(models.Product(name=name, perishability=p))
db.commit()

# ---------- RECIPES ----------
recipes = [

# ================= BREAKFAST (10) =================
("Омлет",2,"breakfast","сковорода",[("яйца",2),("молоко",0.2),("соль",0.01)]),
("Яичница",1,"breakfast","сковорода",[("яйца",2),("масло",0.02)]),
("Блины",2,"breakfast","сковорода",[("яйца",2),("молоко",0.3),("мука",0.2)]),
("Сладкие блинчики",2,"breakfast","сковорода",[("яйца",2),("молоко",0.3),("мука",0.2),("сахар",0.05)]),
("Бутерброды с сыром",2,"breakfast","нож",[("хлеб",2),("сыр",0.1)]),
("Бутерброды с колбасой",2,"breakfast","нож",[("хлеб",2),("колбаса",0.1)]),
("Гренки",2,"breakfast","сковорода",[("хлеб",2),("яйца",1)]),
("Яйца варёные",2,"breakfast","кастрюля",[("яйца",2)]),
("Молочная каша (рис)",2,"breakfast","кастрюля",[("рис",0.15),("молоко",0.3)]),
("Сырники (упрощённые)",2,"breakfast","сковорода",[("сыр",0.2),("яйца",1)]),

# ================= LUNCH (10) =================
("Макароны с сыром",2,"lunch","кастрюля",[("макароны",0.2),("сыр",0.1)]),
("Макароны с колбасой",2,"lunch","кастрюля",[("макароны",0.2),("колбаса",0.2)]),
("Рис с курицей",2,"lunch","кастрюля",[("рис",0.2),("курица",0.3)]),
("Картофельное пюре",2,"lunch","кастрюля",[("картофель",0.5),("молоко",0.1)]),
("Картофель с курицей",2,"lunch","сковорода",[("картофель",0.5),("курица",0.3)]),
("Рис с овощами",2,"lunch","кастрюля",[("рис",0.2),("морковь",0.1),("лук",0.1)]),
("Картофель жареный",2,"lunch","сковорода",[("картофель",0.5),("масло",0.05)]),
("Макароны с маслом",2,"lunch","кастрюля",[("макароны",0.2),("масло",0.05)]),
("Овощное рагу",2,"lunch","кастрюля",[("картофель",0.3),("морковь",0.1),("лук",0.1)]),
("Курица с рисом",2,"lunch","кастрюля",[("курица",0.3),("рис",0.2)]),

# ================= DINNER (10) =================
("Жареная курица",2,"dinner","сковорода",[("курица",0.4),("масло",0.05)]),
("Курица с картофелем",2,"dinner","сковорода",[("курица",0.4),("картофель",0.4)]),
("Картофель с луком",2,"dinner","сковорода",[("картофель",0.5),("лук",0.1)]),
("Макароны с курицей",2,"dinner","кастрюля",[("макароны",0.2),("курица",0.3)]),
("Рис с овощами",2,"dinner","кастрюля",[("рис",0.2),("морковь",0.1),("лук",0.1)]),
("Овощной салат",2,"dinner","нож",[("помидоры",0.2),("огурцы",0.2)]),
("Картофель запечённый",2,"dinner","духовка",[("картофель",0.5)]),
("Куриное филе",2,"dinner","сковорода",[("курица",0.4)]),
("Макароны с сыром",2,"dinner","кастрюля",[("макароны",0.2),("сыр",0.1)]),
("Рис отварной",2,"dinner","кастрюля",[("рис",0.2)]),

# ================= PARTY (10) =================
("Сырная нарезка",4,"party","нож",[("сыр",0.4)]),
("Мясная нарезка",4,"party","нож",[("колбаса",0.4)]),
("Овощная нарезка",4,"party","нож",[("помидоры",0.3),("огурцы",0.3)]),
("Сэндвичи",4,"party","нож",[("хлеб",4),("сыр",0.2),("колбаса",0.2)]),
("Канапе",4,"party","нож",[("хлеб",2),("сыр",0.2)]),
("Салат овощной",4,"party","нож",[("помидоры",0.3),("огурцы",0.3)]),
("Картофель фри",4,"party","сковорода",[("картофель",0.6),("масло",0.1)]),
("Куриные закуски",4,"party","сковорода",[("курица",0.5)]),
("Рулеты из лаваша",4,"party","нож",[("хлеб",2),("сыр",0.2),("майонез",0.05)]),
("Закусочные бутерброды",4,"party","нож",[("хлеб",4),("колбаса",0.3)])
]


for name, servings, meal, equipment, ingredients in recipes:
    r = models.Recipe(
        name=name,
        servings=servings,
        meal_type=meal,
        required_equipment=equipment
    )
    db.add(r)
    db.commit()

    for prod, qty in ingredients:
        unit = "кг" if qty < 1 else "шт"
        db.add(models.RecipeIngredient(
            recipe_id=r.id,
            product=prod,
            quantity=qty,
            unit=unit
        ))

db.commit()
db.close()

print("✅ Создано 40 рецептов (10 на каждый тип)")
